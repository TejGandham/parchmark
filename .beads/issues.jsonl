{"id":"parchmark-1ap","title":"Extract business logic from routers to Service layer","description":"Backend business logic (e.g., markdown processing, note creation logic) sits directly in Routers. This couples concerns and complicates unit testing.\n\n**Current state:**\n- Routers handle HTTP concerns AND business logic\n- Direct DB session dependency in routers\n- Hard to test business logic in isolation\n\n**Recommendation:**\n1. Create a Service layer (e.g., backend/app/services/notes_service.py)\n2. Move business logic out of routers\n3. Consider Repository pattern for data access abstraction\n\n**Benefits:**\n- Better testability (mock services, not HTTP)\n- Clearer separation of concerns\n- Easier to reuse logic across endpoints","status":"tombstone","priority":3,"issue_type":"feature","owner":"46010260+TejGandham@users.noreply.github.com","created_at":"2026-01-28T23:27:46.972015-05:00","created_by":"Tej","updated_at":"2026-01-29T15:09:41.70429-05:00","deleted_at":"2026-01-29T15:09:41.70429-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"feature"}
{"id":"parchmark-28q","title":"Timestamp-based note IDs risk collisions","description":"Note IDs are generated as `note-{milliseconds}` (backend/app/routers/notes.py:82-93) stored in a 50-char PK (backend/app/models/models.py:52-55). Concurrent writes on multiple nodes or fast clients can collide and cause 500 errors.\n\n**Files affected:**\n- backend/app/routers/notes.py:82-93\n- backend/app/models/models.py:52-55\n\n**Fix:**\nUse UUID4 or ULID generated server-side, or a DB-generated PK.\n\n**Impact:** Low - rare but possible collision under concurrent writes","status":"tombstone","priority":3,"issue_type":"bug","owner":"46010260+TejGandham@users.noreply.github.com","created_at":"2026-01-28T23:27:45.909359-05:00","created_by":"Tej","updated_at":"2026-01-29T15:09:41.70429-05:00","deleted_at":"2026-01-29T15:09:41.70429-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"parchmark-36c","title":"Auth tokens stored in localStorage vulnerable to XSS","description":"Zustand persist stores access_token and refresh_token in browser localStorage (ui/src/features/auth/store/auth.ts:286-294), exposing them to any XSS attack and enabling long-lived token theft.\n\n**Files affected:**\n- ui/src/features/auth/store/auth.ts:51-304 (partialize block at 286-294)\n\n**Mitigation options:**\n1. Keep tokens in HTTP-only secure cookies (requires backend changes)\n2. Use in-memory store plus short-lived access tokens\n3. Implement rotating refresh tokens\n\n**Impact:** High - security vulnerability, tokens can be stolen via XSS","status":"tombstone","priority":1,"issue_type":"bug","owner":"46010260+TejGandham@users.noreply.github.com","created_at":"2026-01-28T23:27:43.954863-05:00","created_by":"Tej","updated_at":"2026-01-29T15:09:41.70429-05:00","deleted_at":"2026-01-29T15:09:41.70429-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"parchmark-6gu","title":"App startup continues when DB init fails","description":"init_database() exceptions are swallowed and the app still starts (backend/app/main.py:33-47), leading to runtime 500s once requests hit uninitialized tables.\n\n**Files affected:**\n- backend/app/main.py:33-47\n\n**Fix:**\n1. Re-raise exception or sys.exit(1) on init failure\n2. Surface readiness via health check endpoint\n3. Fail fast to prevent serving broken requests\n\n**Impact:** Medium - silent failures lead to confusing runtime errors","status":"tombstone","priority":2,"issue_type":"bug","owner":"46010260+TejGandham@users.noreply.github.com","created_at":"2026-01-28T23:27:44.667614-05:00","created_by":"Tej","updated_at":"2026-01-29T15:09:41.70429-05:00","deleted_at":"2026-01-29T15:09:41.70429-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"parchmark-9te","title":"Blocking DB calls in async routes cause thread starvation","description":"All routers use async def but call synchronous SessionLocal directly inside the event loop. Under load, each query blocks the worker thread, hurting throughput and latency.\n\n**Files affected:**\n- backend/app/database/database.py:26-44\n- backend/app/routers/notes.py:26-205\n- backend/app/routers/auth.py:32-154\n- backend/app/routers/settings.py:31-233\n\n**Fix options:**\n1. Convert handlers to sync `def` (letting FastAPI run them in a threadpool)\n2. Migrate to SQLAlchemy AsyncEngine/AsyncSession with `await session.execute` and `async_sessionmaker`\n\n**Impact:** High - affects all API endpoints under concurrent load","status":"tombstone","priority":1,"issue_type":"bug","owner":"46010260+TejGandham@users.noreply.github.com","created_at":"2026-01-28T23:27:43.060048-05:00","created_by":"Tej","updated_at":"2026-01-29T15:09:41.70429-05:00","deleted_at":"2026-01-29T15:09:41.70429-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"parchmark-q90","title":"Export endpoint loads entire dataset into memory","description":"/settings/export-notes builds a full in-memory list and ZIP (backend/app/routers/settings.py:113-179), which will OOM or stall for large accounts.\n\n**Files affected:**\n- backend/app/routers/settings.py:113-179\n\n**Fix options:**\n1. Stream notes using chunked query + zipstream/StreamingResponse generator\n2. Enforce pagination/size limits\n3. Background job for large exports with download link\n\n**Impact:** Medium - will crash or hang for users with many notes","status":"tombstone","priority":2,"issue_type":"bug","owner":"46010260+TejGandham@users.noreply.github.com","created_at":"2026-01-28T23:27:45.197701-05:00","created_by":"Tej","updated_at":"2026-01-29T15:09:41.70429-05:00","deleted_at":"2026-01-29T15:09:41.70429-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"parchmark-svk","title":"Server ignores client-supplied note title","description":"NoteCreate.title is validated (backend/app/schemas/schemas.py:54-58) but create_note discards it and re-derives title from content (backend/app/routers/notes.py:82-95), surprising clients and breaking parity with API contract.\n\n**Files affected:**\n- backend/app/schemas/schemas.py:54-58\n- backend/app/routers/notes.py:82-95\n\n**Fix options:**\n1. Honor the provided title if present\n2. Remove title from the request model if it's always derived\n\n**Impact:** Low - API contract mismatch, confusing behavior","status":"tombstone","priority":3,"issue_type":"bug","owner":"46010260+TejGandham@users.noreply.github.com","created_at":"2026-01-28T23:27:46.43897-05:00","created_by":"Tej","updated_at":"2026-01-29T15:09:41.70429-05:00","deleted_at":"2026-01-29T15:09:41.70429-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"parchmark-y84","title":"Consider TanStack Query for server state management","description":"Frontend uses manual API state (loading/error) tracking in Zustand stores, which is repetitive boilerplate.\n\n**Current state:**\n- ui/src/features/notes/store/notes.ts manually tracks loading, error states\n- Each async action needs isLoading, error handling\n- No automatic caching, refetching, or stale-while-revalidate\n\n**Recommendation:**\nAdopt TanStack Query (React Query) for server-state management:\n- Automatic caching and background refetching\n- Built-in loading/error states\n- Optimistic updates\n- Deduplication of requests\n\n**Trade-off:**\n- Migration effort\n- Another dependency\n- Zustand still useful for client-only state (UI preferences, sidebar)\n\n**Priority:** Backlog - nice to have, not urgent","status":"tombstone","priority":4,"issue_type":"feature","owner":"46010260+TejGandham@users.noreply.github.com","created_at":"2026-01-28T23:27:47.505401-05:00","created_by":"Tej","updated_at":"2026-01-29T15:09:41.70429-05:00","deleted_at":"2026-01-29T15:09:41.70429-05:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"feature"}
